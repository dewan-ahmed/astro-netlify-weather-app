---
import { reactive } from "astro";
import Layout from '../components/Layout.astro';
---

<Layout title="Super Simple Astro Weather App">
  <main>
    <div class="container">
      <h1>Super Simple Astro Weather App</h1>
      <div class="buttons">
        <button onclick={getCurrentWeather}>Get Current Weather</button>
        <button onclick={getHistoricWeather}>Get Historic Weather</button>
      </div>
      <div class="input-box">
        <label for="cityName">City Name:</label>
        <input type="text" id="cityName" bind:value={cityName} />
      </div>
      <div class="input-box">
        <label for="startDate">Start Date:</label>
        <input type="date" id="startDate" bind:value={startDate} />
      </div>
      <div class="input-box">
        <label for="endDate">End Date:</label>
        <input type="date" id="endDate" bind:value={endDate} />
      </div>
      <div class="display-box">
        <p>{weatherData}</p>
      </div>
    </div>
  </main>
</Layout>

<script>
  const { reactive, onMount } = Astro;
  const state = reactive({
    cityName: "",
    startDate: "",
    endDate: "",
    weatherData: "",
  });

  async function getCurrentWeather() {
    const { cityName } = state;
    try {
      const response = await fetch(
        `https://api.openweathermap.org/data/2.5/weather?q=${cityName}&appid={API key}`
      );
      const data = await response.json();
      state.weatherData = JSON.stringify(data);
    } catch (error) {
      state.weatherData = `Error: ${error.message}`;
    }
  }

  async function getHistoricWeather() {
    const { cityName, startDate, endDate } = state;
    // Make API call to Java/Spring backend using cityName, startDate, and endDate
    // Update state.weatherData with the response from the backend API
    // Example: state.weatherData = await fetchWeatherData(cityName, startDate, endDate);
  }
</script>

<style>
  /* Add your custom styles here */
  /* ... */
</style>
